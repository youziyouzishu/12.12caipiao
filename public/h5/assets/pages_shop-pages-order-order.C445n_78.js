var e,t;import{r as s,e as a,c as l,a as i,w as r,b as o,i as n,f as d,ae as u,n as c,h as p,F as _,j as h,O as m,l as g,m as f,t as v,p as b,q as y,o as w,aj as x,D as $,$ as S,g as j,d as k,x as C,bg as B}from"./index-Dmu3mr1_.js";import{_ as F}from"./uv-navbar.CCP2bw2Z.js";import{_ as R,u as T}from"./uv-badge.CawE2s1j.js";import{m as z,a as L}from"./mixin.qHq9NBSw.js";import{_ as W}from"./_plugin-vue_export-helper.BCo6x5W8.js";import{_ as O}from"./order-operation.DNiWhOqt.js";import{_ as V}from"./z-paging.BBWlMYJs.js";import"./uv-status-bar.C2pO0b0Y.js";import"./uv-icon.zJBDCHES.js";import"./uv-modal.C8ueCcq2.js";import"./uv-loading-icon.BL07fx-H.js";import"./uv-popup.-CA74lk7.js";import"./uv-overlay.CooXhWSs.js";import"./payment.SSwwOwnZ.js";import"./icon_radio_check.ClKEc5B7.js";import"./icon_radio3.CadTa7NB.js";const D=W({name:"uv-tabs",emits:["click","change"],mixins:[z,L,{props:{duration:{type:Number,default:300},list:{type:Array,default:()=>[]},lineColor:{type:String,default:"#3c9cff"},activeStyle:{type:[String,Object],default:()=>({color:"#303133"})},inactiveStyle:{type:[String,Object],default:()=>({color:"#606266"})},lineWidth:{type:[String,Number],default:20},lineHeight:{type:[String,Number],default:3},lineBgSize:{type:String,default:"cover"},itemStyle:{type:[String,Object],default:()=>({height:"44px"})},scrollable:{type:Boolean,default:!0},current:{type:[Number,String],default:0},keyName:{type:String,default:"name"},...null==(t=null==(e=uni.$uv)?void 0:e.props)?void 0:t.tabs}}],data:()=>({firstTime:!0,scrollLeft:0,scrollViewWidth:0,lineOffsetLeft:0,tabsRect:{left:0},innerCurrent:0,moving:!1}),watch:{current:{immediate:!0,handler(e,t){e!==this.innerCurrent&&(this.innerCurrent=e,this.$nextTick((()=>{this.resize()})))}},list(){this.$nextTick((()=>{this.resize()}))}},computed:{textStyle(){return e=>{const t={},s=e==this.innerCurrent?this.$uv.addStyle(this.activeStyle):this.$uv.addStyle(this.inactiveStyle);return this.list[e].disabled&&(t.color="#c8c9cc"),this.$uv.deepMerge(s,t)}},propsBadge:()=>T},async mounted(){this.init()},methods:{setLineLeft(){const e=this.list[this.innerCurrent];if(!e)return;let t=this.list.slice(0,this.innerCurrent).reduce(((e,t)=>e+t.rect.width),0),s=this.$uv.getPx(this.lineWidth);this.$uv.test.number(this.lineWidth)&&this.$uv.unit&&(s=this.$uv.getPx(`${this.lineWidth}${this.$uv.unit}`)),this.lineOffsetLeft=t+(e.rect.width-s)/2,this.firstTime&&setTimeout((()=>{this.firstTime=!1}),20)},animation(e,t=0){},clickHandler(e,t){this.$emit("click",{...e,index:t}),e.disabled||(this.innerCurrent!=t&&this.$emit("change",{...e,index:t}),this.innerCurrent=t,this.$nextTick((()=>{this.resize()})))},init(){this.$uv.sleep().then((()=>{this.resize()}))},setScrollLeft(){const e=this.list[this.innerCurrent],t=this.list.slice(0,this.innerCurrent).reduce(((e,t)=>e+t.rect.width),0),s=this.$uv.sys().windowWidth;let a=t-(this.tabsRect.width-e.rect.width)/2-(s-this.tabsRect.right)/2+this.tabsRect.left/2;a=Math.min(a,this.scrollViewWidth-this.tabsRect.width),this.scrollLeft=Math.max(0,a)},resize(){0!==this.list.length&&Promise.all([this.getTabsRect(),this.getAllItemRect()]).then((([e,t=[]])=>{this.tabsRect=e,this.scrollViewWidth=0,t.map(((e,t)=>{this.scrollViewWidth+=e.width,this.list[t].rect=e})),this.setLineLeft(),this.setScrollLeft()}))},getTabsRect(){return new Promise((e=>{this.queryRect("uv-tabs__wrapper__scroll-view").then((t=>e(t)))}))},getAllItemRect(){return new Promise((e=>{const t=this.list.map(((e,t)=>this.queryRect(`uv-tabs__wrapper__nav__item-${t}`,!0)));Promise.all(t).then((t=>e(t)))}))},queryRect(e,t){return new Promise((t=>{this.$uvGetRect(`.${e}`).then((e=>{t(e)}))}))}}},[["render",function(e,t,b,y,w,x){const $=g,S=s(a("uv-badge"),R),j=n,k=u;return i(),l(j,{class:"uv-tabs",style:c([e.$uv.addStyle(e.customStyle)])},{default:r((()=>[o(j,{class:"uv-tabs__wrapper"},{default:r((()=>[d(e.$slots,"left",{},void 0,!0),o(j,{class:"uv-tabs__wrapper__scroll-view-wrapper"},{default:r((()=>[o(k,{"scroll-x":e.scrollable,"scroll-left":w.scrollLeft,"scroll-with-animation":"",class:"uv-tabs__wrapper__scroll-view","show-scrollbar":!1,ref:"uv-tabs__wrapper__scroll-view"},{default:r((()=>[o(j,{class:"uv-tabs__wrapper__nav",ref:"uv-tabs__wrapper__nav",style:c({flex:e.scrollable?"":1})},{default:r((()=>[(i(!0),p(_,null,h(e.list,((t,s)=>(i(),l(j,{class:m(["uv-tabs__wrapper__nav__item",[`uv-tabs__wrapper__nav__item-${s}`,t.disabled&&"uv-tabs__wrapper__nav__item--disabled"]]),key:s,onClick:e=>x.clickHandler(t,s),ref_for:!0,ref:`uv-tabs__wrapper__nav__item-${s}`,style:c([{flex:e.scrollable?"":1},e.$uv.addStyle(e.itemStyle)])},{default:r((()=>[o($,{class:m([[t.disabled&&"uv-tabs__wrapper__nav__item__text--disabled"],"uv-tabs__wrapper__nav__item__text"]),style:c([x.textStyle(s)])},{default:r((()=>[f(v(t[e.keyName]),1)])),_:2},1032,["class","style"]),o(S,{show:!(!t.badge||!(t.badge.show||t.badge.isDot||t.badge.value)),isDot:t.badge&&t.badge.isDot||x.propsBadge.isDot,value:t.badge&&t.badge.value||x.propsBadge.value,max:t.badge&&t.badge.max||x.propsBadge.max,type:t.badge&&t.badge.type||x.propsBadge.type,showZero:t.badge&&t.badge.showZero||x.propsBadge.showZero,bgColor:t.badge&&t.badge.bgColor||x.propsBadge.bgColor,color:t.badge&&t.badge.color||x.propsBadge.color,shape:t.badge&&t.badge.shape||x.propsBadge.shape,numberType:t.badge&&t.badge.numberType||x.propsBadge.numberType,inverted:t.badge&&t.badge.inverted||x.propsBadge.inverted,customStyle:"margin-left: 4px;"},null,8,["show","isDot","value","max","type","showZero","bgColor","color","shape","numberType","inverted"])])),_:2},1032,["onClick","style","class"])))),128)),o(j,{class:"uv-tabs__wrapper__nav__line",ref:"uv-tabs__wrapper__nav__line",style:c([{width:e.$uv.addUnit(e.lineWidth),transform:`translate(${w.lineOffsetLeft}px)`,transitionDuration:`${w.firstTime?0:e.duration}ms`,height:w.firstTime?0:e.$uv.addUnit(e.lineHeight),background:e.lineColor,backgroundSize:e.lineBgSize}])},null,8,["style"])])),_:1},8,["style"])])),_:1},8,["scroll-x","scroll-left"])])),_:1}),d(e.$slots,"right",{},void 0,!0)])),_:3})])),_:3},8,["style"])}],["__scopeId","data-v-02da80e0"]]),P=W({__name:"order",setup(e){const t=b(null),d=b([]),u=b([{name:"全部",type:0},{name:"待付款",type:1},{name:"待发货",type:2},{name:"待收货",type:3},{name:"已完成",type:4}]),c=b(0),m=e=>{console.log("handleTabChange e",e),c.value=e.index,d.value=[],t.value.reload()},R=async(e,s)=>{const a={page:e,status:u.value[c.value].type};console.log("查询参数",a);const l=await B(a);console.log("getOrderList",l),t.value.complete(l)};return y((()=>{t.value.reload()})),w((e=>{console.log("options",e),e.type&&(c.value=u.value.findIndex((t=>t.type==e.type))),x("orderRefresh",(()=>{t.value.refresh()}))})),(e,b)=>{const y=s(a("uv-navbar"),F),w=s(a("uv-tabs"),D),x=n,B=g,T=k,z=s(a("order-operation"),O),L=s(a("z-paging"),V);return i(),l(L,{ref_key:"paging",ref:t,modelValue:d.value,"onUpdate:modelValue":b[0]||(b[0]=e=>d.value=e),onQuery:R,"hide-no-more-inside":"","paging-style":{background:"#F5F5F5"},auto:!1},{top:r((()=>[o(y,{title:"我的订单","auto-back":"","bg-color":"#E42B28","title-style":"color: #FFFFFF;font-size: 40rpx;","left-icon-color":"#FFFFFF",placeholder:""}),o(x,{class:""},{default:r((()=>[o(w,{current:c.value,list:u.value,"active-style":"color: #E42B28;font-weight: bold;font-size: 28rpx;","inactive-style":"font-weight: 400;font-size: 28rpx;color: #3E3E3E;","line-color":"#E42B28",scrollable:!1,onChange:m},null,8,["current","list"])])),_:1})])),default:r((()=>[o(x,{class:"px-32 py-20"},{default:r((()=>[(i(!0),p(_,null,h(d.value,((e,t)=>(i(),l(x,{class:"order-item mb-20",key:e.id,onClick:t=>$(S)("/pages_shop/pages/order-detail/order-detail",{id:e.id})},{default:r((()=>[o(x,{class:"order-header flex items-center justify-between"},{default:r((()=>[o(B,{class:"order-no"},{default:r((()=>[f("订单编号："+v(e.ordersn),1)])),_:2},1024),o(B,{class:"order-status"},{default:r((()=>[f(v(e.status_text),1)])),_:2},1024)])),_:2},1024),o(x,{class:"goods-box"},{default:r((()=>[(i(!0),p(_,null,h(e.subs,((e,t)=>(i(),l(x,{class:"flex mb-20",key:t},{default:r((()=>[e.goods?(i(),l(T,{key:0,class:"goods-cover",src:$(C)(e.goods.image),mode:"aspectFill"},null,8,["src"])):j("",!0),o(x,{class:"goods-info flex-1 pl-12"},{default:r((()=>[o(x,{class:"goods-name"},{default:r((()=>{var t;return[f(v(null==(t=e.goods)?void 0:t.name),1)]})),_:2},1024),o(x,{class:"goods-sku mt-12"},{default:r((()=>[f(v(e.tag),1)])),_:2},1024),o(x,{class:"flex items-center justify-between mt-12"},{default:r((()=>[o(B,{class:"goods-price"},{default:r((()=>[f("￥"+v(e.amount),1)])),_:2},1024),o(B,{class:"goods-num"},{default:r((()=>[f("x"+v(e.num),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128))])),_:2},1024),o(x,{class:"mt-20 flex items-end justify-end goods-total"},{default:r((()=>[f(" 共1件商品，应付款："),o(B,{class:"price"},{default:r((()=>[f("￥"+v(e.pay_amount),1)])),_:2},1024)])),_:2},1024),o(x,{class:"mt-20"},{default:r((()=>[o(z,{customStyle:"padding-right: 0;",order:e},null,8,["order"])])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1})])),_:1},8,["modelValue"])}}},[["__scopeId","data-v-d2437788"]]);export{P as default};
